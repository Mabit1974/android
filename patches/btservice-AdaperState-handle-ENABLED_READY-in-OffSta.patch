From 49b337220e46227bbdcfd6e75d53f65e15bbb73e Mon Sep 17 00:00:00 2001
From: James Sullins <jcsullins@gmail.com>
Date: Thu, 14 May 2015 14:56:41 +0200
Subject: [PATCH] btservice/AdaperState: handle ENABLED_READY in OffState

---
 src/com/android/bluetooth/btservice/AdapterState.java | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/src/com/android/bluetooth/btservice/AdapterState.java b/src/com/android/bluetooth/btservice/AdapterState.java
index 3469068..726e10c 100644
--- a/src/com/android/bluetooth/btservice/AdapterState.java
+++ b/src/com/android/bluetooth/btservice/AdapterState.java
@@ -138,6 +138,12 @@ final class AdapterState extends StateMachine {
                    if (DBG) Log.d(TAG,"CURRENT_STATE=OFF, MESSAGE = USER_TURN_OFF");
                    //TODO: Handle case of service started and stopped without enable
                    break;
+               case ENABLED_READY:
+                   if (DBG) Log.d(TAG,"CURRENT_STATE=OFF, MESSAGE = ENABLED_READY");
+                   mAdapterProperties.onBluetoothReady();
+                   transitionTo(mOnState);
+                   notifyAdapterStateChange(BluetoothAdapter.STATE_ON);
+                   break;
                default:
                    if (DBG) Log.d(TAG,"ERROR: UNEXPECTED MESSAGE: CURRENT_STATE=OFF, MESSAGE = " + msg.what );
                    return false;
-- 
2.4.0

